"use strict";var _require=require("../models/queryModel"),query=_require.query,_require2=require("uuid"),uuidv4=_require2.v4;exports.usersPetArrays=function(t,r){var n,a,s;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.decoded.userID,e.next=4,regeneratorRuntime.awrap(query('SELECT * FROM pets JOIN savedPets on pets.pet_ID = savedPets.pet_ID WHERE user_ID = "'.concat(n,'"')));case 4:return a=e.sent,e.next=7,regeneratorRuntime.awrap(query('SELECT * FROM pets JOIN adoptedPets on pets.pet_ID = adoptedPets.pet_ID WHERE user_ID = "'.concat(n,'"')));case 7:s=e.sent,r.send({savedPetsArray:a,adoptedPetsArray:s}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),r.status(500).send(e.t0.message);case 14:case"end":return e.stop()}},null,null,[[0,11]])},exports.getAllPetsArray=function(e,t){var r;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,regeneratorRuntime.awrap(query("SELECT * FROM pets"));case 3:r=e.sent,t.send(r),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0),t.status(500).send(e.t0.message);case 11:case"end":return e.stop()}},null,null,[[0,7]])},exports.returnForAdoption=function(t,r){var n,a;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.params.petID,a=t.decoded.userID,e.next=5,regeneratorRuntime.awrap(query('DELETE FROM adoptedPets WHERE user_ID = "'.concat(a,'" AND pet_ID = "').concat(n,'";')));case 5:return e.sent,e.next=8,regeneratorRuntime.awrap(query('UPDATE pets SET adoption_status = "available", availability = TRUE  WHERE pet_ID = "'.concat(n,'"')));case 8:e.sent,r.send("Returned Succesfully!"),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),console.error(e.t0),r.status(500).send(e.t0.message);case 16:case"end":return e.stop()}},null,null,[[0,12]])},exports.fosterToAdopt=function(t,r){var n;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.body.petID,e.next=4,regeneratorRuntime.awrap(query('UPDATE pets SET adoption_status = "adopted"  WHERE pet_ID = "'.concat(n,'"')));case 4:e.sent,r.send("Updated Succesfully!"),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0),r.status(500).send(e.t0.message);case 12:case"end":return e.stop()}},null,null,[[0,8]])},exports.unsavePet=function(t,r){var n,a;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.params.petID,a=t.decoded.userID,e.next=5,regeneratorRuntime.awrap(query('DELETE FROM savedPets WHERE user_ID = "'.concat(a,'" AND pet_ID = "').concat(n,'";')));case 5:e.sent,r.send("Unsaved Succesfully!"),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0),r.status(500).send(e.t0.message);case 13:case"end":return e.stop()}},null,null,[[0,9]])},exports.savePet=function(t,r){var n,a;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.body.petID,a=t.decoded.userID,e.next=5,regeneratorRuntime.awrap(query('INSERT INTO savedPets (user_ID, pet_ID) VALUES ("'.concat(a,'", "').concat(n,'")')));case 5:e.sent,r.send("Saved Succesfully!"),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0),r.status(500).send(e.t0.message);case 13:case"end":return e.stop()}},null,null,[[0,9]])},exports.adoptPet=function(t,r){var n,a;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.body.petID,a=t.decoded.userID,e.next=5,regeneratorRuntime.awrap(query('INSERT INTO adoptedPets (user_ID, pet_ID) VALUES ("'.concat(a,'", "').concat(n,'")')));case 5:return e.sent,e.next=8,regeneratorRuntime.awrap(query('UPDATE pets SET adoption_status = "adopted", availability = FALSE WHERE pet_ID = "'.concat(n,'"')));case 8:e.sent,r.send("Adoption Success!"),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),console.error(e.t0),r.status(500).send(e.t0.message);case 16:case"end":return e.stop()}},null,null,[[0,12]])},exports.fosterPet=function(t,r){var n,a;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.body.petID,a=t.decoded.userID,e.next=5,regeneratorRuntime.awrap(query('INSERT INTO adoptedPets (user_ID, pet_ID) VALUES ("'.concat(a,'", "').concat(n,'")')));case 5:return e.sent,e.next=8,regeneratorRuntime.awrap(query('UPDATE pets SET adoption_status = "fostered", availability = FALSE WHERE pet_ID = "'.concat(n,'"')));case 8:e.sent,r.send("Foster Success!"),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),console.error(e.t0),r.status(500).send(e.t0.message);case 16:case"end":return e.stop()}},null,null,[[0,12]])},exports.basicSearch=function(t,r){var n,a;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.query.type,e.next=4,regeneratorRuntime.awrap(query('SELECT * FROM pets WHERE type = "'.concat(n,'"')));case 4:a=e.sent,r.send(a),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0),r.status(500).send(e.t0.message);case 12:case"end":return e.stop()}},null,null,[[0,8]])},exports.advanceSearch=function(t,r){var n,a,s,c,o,u,i,p,d;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.params,a=n.type,s=n.adoptionStatus,c=n.minHeight,o=n.maxHeight,u=n.minWeight,i=n.maxWeight,p=t.query.name,e.next=5,regeneratorRuntime.awrap(query('SELECT * FROM pets WHERE type = "'.concat(a,'" AND adoption_status = "').concat(s,'" AND weight >= ').concat(u," AND weight <= ").concat(i," AND height >= ").concat(c," AND height <= ").concat(o," AND name LIKE '%").concat(p,"%'")));case 5:d=e.sent,r.send(d),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0),r.status(500).send(e.t0.message);case 13:case"end":return e.stop()}},null,null,[[0,9]])},exports.addPet=function(t,r){var n,a,s,c,o,u,i,p,d,l,y,v,g,h,E,m,x,R;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.file.filename,a=t.body,s=a.type,c=a.adoptionStatus,o=a.name,u=a.colour,i=a.height,p=a.weight,d=a.bio,l=a.dietryRestrictions,y=a.hypoallergenic,v=a.breed,g=JSON.parse(i),h=JSON.parse(p),E=JSON.parse(y),m="available"===c?!0:!1,x=uuidv4(),R=(new Date).toISOString().slice(0,19).replace("T"," "),e.next=12,regeneratorRuntime.awrap(query("INSERT INTO pets (pet_ID, type, name, adoption_status, picture_path, height, weight, color, bio, hypoallergenic, availability, dietry_restrictions, breed, date_created) VALUES ('".concat(x,"', '").concat(s,"', '").concat(o,"', '").concat(c,"', '").concat(n,"', ").concat(g,", ").concat(h,", '").concat(u,"', '").concat(d,"', ").concat(E,", ").concat(m,", '").concat(l,"', '").concat(v,"', '").concat(R,"')")));case 12:r.send("Added Successfully!"),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),r.status(500).send(e.t0.message);case 18:case"end":return e.stop()}},null,null,[[0,15]])},exports.editPetWithNewPhoto=function(t,r){var n,a,s,c,o,u,i,p,d,l,y,v,g,h,E,m,x;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.file.filename,a=t.body,s=a.petID,c=a.type,o=a.adoptionStatus,u=a.name,i=a.colour,p=a.height,d=a.weight,l=a.bio,y=a.dietryRestrictions,v=a.hypoallergenic,g=a.breed,h=JSON.parse(p),E=JSON.parse(d),m=JSON.parse(v),x="available"===o?!0:!1,e.next=10,regeneratorRuntime.awrap(query('UPDATE pets SET type = "'.concat(c,'", adoption_status = "').concat(o,'", name = "').concat(u,'", color = "').concat(i,'", picture_path = "').concat(n,'", height = ').concat(h,", weight = ").concat(E,', bio = "').concat(l,'", dietry_restrictions = "').concat(y,'", hypoallergenic = ').concat(m,', breed = "').concat(g,'", availability = ').concat(x,'  WHERE pet_ID = "').concat(s,'"')));case 10:e.sent,r.send("Updated Successfully!"),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(0),console.log(e.t0),r.status(500).send(e.t0.message);case 18:case"end":return e.stop()}},null,null,[[0,14]])},exports.editPetWithoutNewPhoto=function(t,r){var n,a,s,c,o,u,i,p,d,l,y,v,g;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.body,a=n.petID,s=n.type,c=n.adoptionStatus,o=n.name,u=n.colour,i=n.height,p=n.weight,d=n.bio,l=n.dietryRestrictions,y=n.hypoallergenic,v=n.breed,g="available"===c?!0:!1,e.next=6,regeneratorRuntime.awrap(query('UPDATE pets SET type = "'.concat(s,'", adoption_status = "').concat(c,'", name = "').concat(o,'", color = "').concat(u,'", height = ').concat(i,", weight = ").concat(p,', bio = "').concat(d,'", dietry_restrictions = "').concat(l,'", hypoallergenic = ').concat(y,', breed = "').concat(v,'", availability = ').concat(g,'  WHERE pet_ID = "').concat(a,'"')));case 6:e.sent,r.send("Updated Successfully!"),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0),r.status(500).send(e.t0.message);case 14:case"end":return e.stop()}},null,null,[[0,10]])};