"use strict";var _require=require("../models/queryModel"),query=_require.query,_require2=require("uuid"),uuidv4=_require2.v4;exports.getSavedPetsArray=function(t,r){var n,a;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.decoded.userID,e.next=4,regeneratorRuntime.awrap(query('SELECT * FROM pets JOIN savedPets on pets.pet_ID = savedPets.pet_ID WHERE user_ID = "'.concat(n,'"')));case 4:a=e.sent,r.send(a),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}},null,null,[[0,8]])},exports.getAdoptedPetsArray=function(t,r){var n,a;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.decoded.userID,e.next=4,regeneratorRuntime.awrap(query('SELECT * FROM pets JOIN adoptedPets on pets.pet_ID = adoptedPets.pet_ID WHERE user_ID = "'.concat(n,'"')));case 4:a=e.sent,r.send(a),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}},null,null,[[0,8]])},exports.getAllPetsArray=function(e,t){var r;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,regeneratorRuntime.awrap(query("SELECT * FROM pets"));case 3:r=e.sent,t.send(r),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}},null,null,[[0,7]])},exports.returnForAdoption=function(t,r){var n,a;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.params.petID,a=t.decoded.userID,e.next=5,regeneratorRuntime.awrap(query('DELETE FROM adoptedPets WHERE user_ID = "'.concat(a,'" AND pet_ID = "').concat(n,'";')));case 5:return e.sent,e.next=8,regeneratorRuntime.awrap(query('UPDATE pets SET adoption_status = "available", availability = TRUE  WHERE pet_ID = "'.concat(n,'"')));case 8:e.sent,r.send("Returned Succesfully!"),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.error(e.t0);case 15:case"end":return e.stop()}},null,null,[[0,12]])},exports.fosterToAdopt=function(t,r){var n;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.body.petID,e.next=4,regeneratorRuntime.awrap(query('UPDATE pets SET adoption_status = "adopted"  WHERE pet_ID = "'.concat(n,'"')));case 4:e.sent,r.send("Updated Succesfully!"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}},null,null,[[0,8]])},exports.unsavePet=function(t,r){var n,a;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.params.petID,a=t.decoded.userID,e.next=5,regeneratorRuntime.awrap(query('DELETE FROM savedPets WHERE user_ID = "'.concat(a,'" AND pet_ID = "').concat(n,'";')));case 5:e.sent,r.send("Unsaved Succesfully!"),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0);case 12:case"end":return e.stop()}},null,null,[[0,9]])},exports.savePet=function(t,r){var n,a;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.body.petID,a=t.decoded.userID,e.next=5,regeneratorRuntime.awrap(query('INSERT INTO savedPets (user_ID, pet_ID) VALUES ("'.concat(a,'", "').concat(n,'")')));case 5:e.sent,r.send("Saved Succesfully!"),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0);case 12:case"end":return e.stop()}},null,null,[[0,9]])},exports.adoptPet=function(t,r){var n,a;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.body.petID,a=t.decoded.userID,e.next=5,regeneratorRuntime.awrap(query('INSERT INTO adoptedPets (user_ID, pet_ID) VALUES ("'.concat(a,'", "').concat(n,'")')));case 5:return e.sent,e.next=8,regeneratorRuntime.awrap(query('UPDATE pets SET adoption_status = "adopted", availability = FALSE WHERE pet_ID = "'.concat(n,'"')));case 8:e.sent,r.send("Adoption Success!"),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.error(e.t0);case 15:case"end":return e.stop()}},null,null,[[0,12]])},exports.fosterPet=function(t,r){var n,a;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.body.petID,a=t.decoded.userID,e.next=5,regeneratorRuntime.awrap(query('INSERT INTO adoptedPets (user_ID, pet_ID) VALUES ("'.concat(a,'", "').concat(n,'")')));case 5:return e.sent,e.next=8,regeneratorRuntime.awrap(query('UPDATE pets SET adoption_status = "fostered", availability = FALSE WHERE pet_ID = "'.concat(n,'"')));case 8:e.sent,r.send("Foster Success!"),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.error(e.t0);case 15:case"end":return e.stop()}},null,null,[[0,12]])},exports.basicSearch=function(t,r){var n,a;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.query.type,e.next=4,regeneratorRuntime.awrap(query('SELECT * FROM pets WHERE type = "'.concat(n,'"')));case 4:a=e.sent,r.send(a),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}},null,null,[[0,8]])},exports.advanceSearch=function(t,r){var n,a,c,o,s,u,i,p,l;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.params,a=n.type,c=n.adoptionStatus,o=n.minHeight,s=n.maxHeight,u=n.minWeight,i=n.maxWeight,p=t.query.name,e.next=5,regeneratorRuntime.awrap(query('SELECT * FROM pets WHERE type = "'.concat(a,'" AND adoption_status = "').concat(c,'" AND weight >= ').concat(u," AND weight <= ").concat(i," AND height >= ").concat(o," AND height <= ").concat(s," AND name LIKE '%").concat(p,"%'")));case 5:l=e.sent,r.send(l),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}},null,null,[[0,9]])},exports.addPet=function(t,r){var n,a,c,o,s,u,i,p,l,d,y,v,h,g,E,x,R,f;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.file.filename,a=t.body,c=a.type,o=a.adoptionStatus,s=a.name,u=a.colour,i=a.height,p=a.weight,l=a.bio,d=a.dietryRestrictions,y=a.hypoallergenic,v=a.breed,h=JSON.parse(i),g=JSON.parse(p),E=JSON.parse(y),x="available"===o?!0:!1,R=uuidv4(),f=(new Date).toISOString().slice(0,19).replace("T"," "),e.next=12,regeneratorRuntime.awrap(query("INSERT INTO pets (pet_ID, type, name, adoption_status, picture_path, height, weight, color, bio, hypoallergenic, availability, dietry_restrictions, breed, date_created) VALUES ('".concat(R,"', '").concat(c,"', '").concat(s,"', '").concat(o,"', '").concat(n,"', ").concat(h,", ").concat(g,", '").concat(u,"', '").concat(l,"', ").concat(E,", ").concat(x,", '").concat(d,"', '").concat(v,"', '").concat(f,"')")));case 12:r.send("Added Successfully!"),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),console.log(e.t0);case 18:case"end":return e.stop()}},null,null,[[0,15]])},exports.editPetWithNewPhoto=function(t,r){var n,a,c,o,s,u,i,p,l,d,y,v,h,g,E,x,R;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.file.filename,a=t.body,c=a.petID,o=a.type,s=a.adoptionStatus,u=a.name,i=a.colour,p=a.height,l=a.weight,d=a.bio,y=a.dietryRestrictions,v=a.hypoallergenic,h=a.breed,g=JSON.parse(p),E=JSON.parse(l),x=JSON.parse(v),R="available"===s?!0:!1,e.next=10,regeneratorRuntime.awrap(query('UPDATE pets SET type = "'.concat(o,'", adoption_status = "').concat(s,'", name = "').concat(u,'", color = "').concat(i,'", picture_path = "').concat(n,'", height = ').concat(g,", weight = ").concat(E,', bio = "').concat(d,'", dietry_restrictions = "').concat(y,'", hypoallergenic = ').concat(x,', breed = "').concat(h,'", availability = ').concat(R,'  WHERE pet_ID = "').concat(c,'"')));case 10:e.sent,r.send("Updated Successfully!"),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.log(e.t0);case 17:case"end":return e.stop()}},null,null,[[0,14]])},exports.editPetWithoutNewPhoto=function(t,r){var n,a,c,o,s,u,i,p,l,d,y,v,h;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.body,a=n.petID,c=n.type,o=n.adoptionStatus,s=n.name,u=n.colour,i=n.height,p=n.weight,l=n.bio,d=n.dietryRestrictions,y=n.hypoallergenic,v=n.breed,h="available"===o?!0:!1,e.next=6,regeneratorRuntime.awrap(query('UPDATE pets SET type = "'.concat(c,'", adoption_status = "').concat(o,'", name = "').concat(s,'", color = "').concat(u,'", height = ').concat(i,", weight = ").concat(p,', bio = "').concat(l,'", dietry_restrictions = "').concat(d,'", hypoallergenic = ').concat(y,', breed = "').concat(v,'", availability = ').concat(h,'  WHERE pet_ID = "').concat(a,'"')));case 6:e.sent,r.send("Updated Successfully!"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}},null,null,[[0,10]])};