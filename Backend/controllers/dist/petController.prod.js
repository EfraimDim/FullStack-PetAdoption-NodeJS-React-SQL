"use strict";function _templateObject19(){var e=_taggedTemplateLiteral(["DELETE FROM savedPets WHERE pet_ID = "," "]);return _templateObject19=function(){return e},e}function _templateObject18(){var e=_taggedTemplateLiteral(["DELETE FROM adoptedPets WHERE pet_ID = "," "]);return _templateObject18=function(){return e},e}function _templateObject17(){var e=_taggedTemplateLiteral(["DELETE FROM pets WHERE pet_ID = "," "]);return _templateObject17=function(){return e},e}function _templateObject16(){var e=_taggedTemplateLiteral(["UPDATE pets SET type = ",", adoption_status = ",", name = ",", color = ",", height = ",", weight = ",", bio = ",", dietry_restrictions = ",", hypoallergenic = ",", breed = ",", availability = ","  WHERE pet_ID = ",""]);return _templateObject16=function(){return e},e}function _templateObject15(){var e=_taggedTemplateLiteral(["UPDATE pets SET type = ",", adoption_status = ",", name = ",", color = ",", picture_path = ",", height = ",", weight = ",", bio = ",", dietry_restrictions = ",", hypoallergenic = ",", breed = ",", availability = ","  WHERE pet_ID = ",""]);return _templateObject15=function(){return e},e}function _templateObject14(){var e=_taggedTemplateLiteral(["INSERT INTO pets (pet_ID, type, name, adoption_status, picture_path, height, weight, color, bio, hypoallergenic, availability, dietry_restrictions, breed, date_created) VALUES (",", ",", ",", ",", ",", ",", ",", ",", ",", ",", ",", ",", ",", ",")"]);return _templateObject14=function(){return e},e}function _templateObject13(){var e=_taggedTemplateLiteral(["SELECT * FROM pets WHERE type = ",""]);return _templateObject13=function(){return e},e}function _templateObject12(){var e=_taggedTemplateLiteral(['UPDATE pets SET adoption_status = "fostered", availability = FALSE WHERE pet_ID = ',""]);return _templateObject12=function(){return e},e}function _templateObject11(){var e=_taggedTemplateLiteral(["INSERT INTO adoptedPets (user_ID, pet_ID) VALUES (",", ",")"]);return _templateObject11=function(){return e},e}function _templateObject10(){var e=_taggedTemplateLiteral(['UPDATE pets SET adoption_status = "adopted", availability = FALSE WHERE pet_ID = ',""]);return _templateObject10=function(){return e},e}function _templateObject9(){var e=_taggedTemplateLiteral(["INSERT INTO adoptedPets (user_ID, pet_ID) VALUES (",", ",")"]);return _templateObject9=function(){return e},e}function _templateObject8(){var e=_taggedTemplateLiteral(["INSERT INTO savedPets (user_ID, pet_ID) VALUES (",", ",")"]);return _templateObject8=function(){return e},e}function _templateObject7(){var e=_taggedTemplateLiteral(["DELETE FROM savedPets WHERE user_ID = "," AND pet_ID = ",";"]);return _templateObject7=function(){return e},e}function _templateObject6(){var e=_taggedTemplateLiteral(['UPDATE pets SET adoption_status = "adopted"  WHERE pet_ID = ',""]);return _templateObject6=function(){return e},e}function _templateObject5(){var e=_taggedTemplateLiteral(['UPDATE pets SET adoption_status = "available", availability = TRUE  WHERE pet_ID = ',""]);return _templateObject5=function(){return e},e}function _templateObject4(){var e=_taggedTemplateLiteral(["DELETE FROM adoptedPets WHERE user_ID = "," AND pet_ID = ",";"]);return _templateObject4=function(){return e},e}function _templateObject3(){var e=_taggedTemplateLiteral(["SELECT * FROM pets"]);return _templateObject3=function(){return e},e}function _templateObject2(){var e=_taggedTemplateLiteral(["SELECT * FROM pets JOIN adoptedPets on pets.pet_ID = adoptedPets.pet_ID WHERE user_ID = ",""]);return _templateObject2=function(){return e},e}function _templateObject(){var e=_taggedTemplateLiteral(["SELECT * FROM pets JOIN savedPets on pets.pet_ID = savedPets.pet_ID WHERE user_ID = ",""]);return _templateObject=function(){return e},e}function _taggedTemplateLiteral(e,t){return t=t||e.slice(0),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var SQL=require("@nearform/sql"),_require=require("../lib/mysql"),query=_require.query,_require2=require("uuid"),uuidv4=_require2.v4;exports.usersPetArrays=function(t,r){var n,a,s;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.decoded.userID,e.next=4,regeneratorRuntime.awrap(query(SQL(_templateObject(),n)));case 4:return a=e.sent,e.next=7,regeneratorRuntime.awrap(query(SQL(_templateObject2(),n)));case 7:s=e.sent,r.send({savedPetsArray:a,adoptedPetsArray:s}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),r.status(500).send(e.t0.message);case 14:case"end":return e.stop()}},null,null,[[0,11]])},exports.getAllPetsArray=function(e,t){var r;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,regeneratorRuntime.awrap(query(SQL(_templateObject3())));case 3:r=e.sent,t.send(r),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0),t.status(500).send(e.t0.message);case 11:case"end":return e.stop()}},null,null,[[0,7]])},exports.returnForAdoption=function(t,r){var n,a,s,c,u,o;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.params,a=n.petID,s=n.petName,c=n.petType,u=n.userEmail,o=t.decoded.userID,e.next=5,regeneratorRuntime.awrap(query(SQL(_templateObject4(),o,a)));case 5:return e.sent,e.next=8,regeneratorRuntime.awrap(query(SQL(_templateObject5(),a)));case 8:return e.sent,e.next=11,regeneratorRuntime.awrap(query('INSERT INTO newsfeed (news) VALUES ("'.concat(u," has returned ").concat(s," the ").concat(c,' back for adoption")')));case 11:e.sent,r.send("Returned Succesfully!"),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(0),console.error(e.t0),r.status(500).send(e.t0.message);case 19:case"end":return e.stop()}},null,null,[[0,15]])},exports.fosterToAdopt=function(t,r){var n,a,s,c,u;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.body,a=n.petID,s=n.name,c=n.type,u=n.userEmail,e.next=4,regeneratorRuntime.awrap(query(SQL(_templateObject6(),a)));case 4:return e.sent,e.next=7,regeneratorRuntime.awrap(query('INSERT INTO newsfeed (news) VALUES ("'.concat(u," had now adopted ").concat(s," the ").concat(c,' from fostering!")')));case 7:e.sent,r.send("Updated Succesfully!"),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),console.error(e.t0),r.status(500).send(e.t0.message);case 15:case"end":return e.stop()}},null,null,[[0,11]])},exports.unsavePet=function(t,r){var n,a;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.params.petID,a=t.decoded.userID,e.next=5,regeneratorRuntime.awrap(query(SQL(_templateObject7(),a,n)));case 5:e.sent,r.send("Unsaved Succesfully!"),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0),r.status(500).send(e.t0.message);case 13:case"end":return e.stop()}},null,null,[[0,9]])},exports.savePet=function(t,r){var n,a;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.body.petID,a=t.decoded.userID,e.next=5,regeneratorRuntime.awrap(query(SQL(_templateObject8(),a,n)));case 5:e.sent,r.send("Saved Succesfully!"),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0),r.status(500).send(e.t0.message);case 13:case"end":return e.stop()}},null,null,[[0,9]])},exports.adoptPet=function(t,r){var n,a,s,c,u,o;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.body,a=n.petID,s=n.name,c=n.type,u=n.userEmail,o=t.decoded.userID,e.next=5,regeneratorRuntime.awrap(query(SQL(_templateObject9(),o,a)));case 5:return e.sent,e.next=8,regeneratorRuntime.awrap(query(SQL(_templateObject10(),a)));case 8:return e.sent,e.next=11,regeneratorRuntime.awrap(query('INSERT INTO newsfeed (news) VALUES ("'.concat(u," had now adopted ").concat(s," the ").concat(c,'!")')));case 11:e.sent,r.send("Adoption Success!"),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(0),console.error(e.t0),r.status(500).send(e.t0.message);case 19:case"end":return e.stop()}},null,null,[[0,15]])},exports.fosterPet=function(t,r){var n,a,s,c,u,o;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.body,a=n.petID,s=n.name,c=n.type,u=n.userEmail,o=t.decoded.userID,e.next=5,regeneratorRuntime.awrap(query(SQL(_templateObject11(),o,a)));case 5:return e.sent,e.next=8,regeneratorRuntime.awrap(query(SQL(_templateObject12(),a)));case 8:return e.sent,e.next=11,regeneratorRuntime.awrap(query('INSERT INTO newsfeed (news) VALUES ("'.concat(u," is now fostering ").concat(s," the ").concat(c,'!")')));case 11:e.sent,r.send("Foster Success!"),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(0),console.error(e.t0),r.status(500).send(e.t0.message);case 19:case"end":return e.stop()}},null,null,[[0,15]])},exports.basicSearch=function(t,r){var n,a;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.query.type,e.next=4,regeneratorRuntime.awrap(query(SQL(_templateObject13(),n)));case 4:a=e.sent,r.send(a),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0),r.status(500).send(e.t0.message);case 12:case"end":return e.stop()}},null,null,[[0,8]])},exports.advanceSearch=function(t,r){var n,a,s,c,u,o,p,i,l;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.params,a=n.type,s=n.adoptionStatus,c=n.minHeight,u=n.maxHeight,o=n.minWeight,p=n.maxWeight,i=t.query.name,e.next=5,regeneratorRuntime.awrap(query('SELECT * FROM pets WHERE type = "'.concat(a,"\" AND adoption_status = '").concat(s,"' AND weight >= ").concat(o," AND weight <= ").concat(p," AND height >= ").concat(c," AND height <= ").concat(u," AND name LIKE '%").concat(i,"%'")));case 5:l=e.sent,r.send(l),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0),r.status(500).send(e.t0.message);case 13:case"end":return e.stop()}},null,null,[[0,9]])},exports.addPet=function(t,r){var n,a,s,c,u,o,p,i,l,d,m,g,_,f,b,E,v,y,O;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.file.filename,a=t.body,s=a.type,c=a.adoptionStatus,u=a.name,o=a.colour,p=a.height,i=a.weight,l=a.bio,d=a.dietryRestrictions,m=a.hypoallergenic,g=a.breed,_=a.adminEmail,f=JSON.parse(p),b=JSON.parse(i),E=JSON.parse(m),v="available"===c?!0:!1,y=uuidv4(),O=(new Date).toISOString().slice(0,19).replace("T"," "),e.next=12,regeneratorRuntime.awrap(query(SQL(_templateObject14(),y,s,u,c,n,f,b,o,l,E,v,d,g,O)));case 12:return e.next=14,regeneratorRuntime.awrap(query('INSERT INTO newsfeed (news) VALUES ("Admin: '.concat(_," has added ").concat(u," the ").concat(s,' to the database!")')));case 14:e.sent,r.send("Added Successfully!"),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(0),r.status(500).send(e.t0.message);case 21:case"end":return e.stop()}},null,null,[[0,18]])},exports.editPetWithNewPhoto=function(t,r){var n,a,s,c,u,o,p,i,l,d,m,g,_,f,b,E,v,y;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.file.filename,a=t.body,s=a.petID,c=a.type,u=a.adoptionStatus,o=a.name,p=a.colour,i=a.height,l=a.weight,d=a.bio,m=a.dietryRestrictions,g=a.hypoallergenic,_=a.breed,f=a.adminEmail,b=JSON.parse(i),E=JSON.parse(l),v=JSON.parse(g),y="available"===u?!0:!1,e.next=10,regeneratorRuntime.awrap(query(SQL(_templateObject15(),c,u,o,p,n,b,E,d,m,v,_,y,s)));case 10:return e.sent,e.next=13,regeneratorRuntime.awrap(query('INSERT INTO newsfeed (news) VALUES ("Admin: '.concat(f," has edited the information of ").concat(o," the ").concat(c,' and added a new photo!")')));case 13:e.sent,r.send("Updated Successfully!"),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(0),console.log(e.t0),r.status(500).send(e.t0.message);case 21:case"end":return e.stop()}},null,null,[[0,17]])},exports.editPetWithoutNewPhoto=function(t,r){var n,a,s,c,u,o,p,i,l,d,m,g,_,f;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.body,a=n.petID,s=n.type,c=n.adoptionStatus,u=n.name,o=n.colour,p=n.height,i=n.weight,l=n.bio,d=n.dietryRestrictions,m=n.hypoallergenic,g=n.breed,_=n.adminEmail,f="available"===c?!0:!1,e.next=6,regeneratorRuntime.awrap(query(SQL(_templateObject16(),s,c,u,o,p,i,l,d,m,g,f,a)));case 6:return e.sent,e.next=9,regeneratorRuntime.awrap(query('INSERT INTO newsfeed (news) VALUES ("Admin: '.concat(_," has edited the information of ").concat(u," the ").concat(s,'!")')));case 9:e.sent,r.send("Updated Successfully!"),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(0),console.log(e.t0),r.status(500).send(e.t0.message);case 17:case"end":return e.stop()}},null,null,[[0,13]])},exports.deletePet=function(t,r){var n,a,s,c,u;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.params,a=n.petID,s=n.petName,c=n.petType,u=n.adminEmail,e.next=4,regeneratorRuntime.awrap(query(SQL(_templateObject17(),a)));case 4:return e.sent,e.next=7,regeneratorRuntime.awrap(query(SQL(_templateObject18(),a)));case 7:return e.sent,e.next=10,regeneratorRuntime.awrap(query(SQL(_templateObject19(),a)));case 10:return e.sent,e.next=13,regeneratorRuntime.awrap(query('INSERT INTO newsfeed (news) VALUES ("Admin: '.concat(u," has deleted ").concat(s," the ").concat(c,' from all databases!")')));case 13:e.sent,r.send("Delete Succesful!"),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(0),console.error(e.t0),r.status(500).send(e.t0.message);case 21:case"end":return e.stop()}},null,null,[[0,17]])};